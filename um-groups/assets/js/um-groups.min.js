var um_groups_members_directory_busy=[],um_groups_members_directories=[];function um_get_group_filters_data(n){var p=[];return n.find(".um-search-filter").each(function(){var t,a,o,u=jQuery(this);if(u.find("input.um-datepicker-filter").length)o="datepicker",u.find("input.um-datepicker-filter").each(function(){if("to"!==jQuery(this).data("range")){var e=jQuery(this).data("filter_name"),r=um_get_data_for_directory(n,"filter_"+e+"_from"),t=um_get_data_for_directory(n,"filter_"+e+"_to");if(void 0!==r||void 0!==t){var a,u=jQuery(this).val(),s=n.find('input.um-datepicker-filter[data-range="to"][data-filter_name="'+e+'"]').val();u===s?a=s:""!==u&&""!==s?a=u+" - "+s:""===u?a="before "+s:""===s&&(a="since "+u),p.push({name:e,label:jQuery(this).data("filter-label"),value_label:a,value:[r,t],type:o})}}});else if(u.find("input.um-timepicker-filter").length)o="timepicker",u.find("input.um-timepicker-filter").each(function(){if("to"!==jQuery(this).data("range")){var e=jQuery(this).data("filter_name"),r=um_get_data_for_directory(n,"filter_"+e+"_from"),t=um_get_data_for_directory(n,"filter_"+e+"_to");if(void 0!==r||void 0!==t){var a,u=jQuery(this).val(),s=n.find('input.um-timepicker-filter[data-range="to"][data-filter_name="'+e+'"]').val();u===s?a=s:""!==u&&""!==s?a=u+" - "+s:""===u?a="before "+s:""===s&&(a="since "+u),p.push({name:e,label:jQuery(this).data("filter-label"),value_label:a,value:[r,t],type:o})}}});else if(u.find("select").length){o="select",t=u.find("select").attr("name"),a=u.find("select").data("placeholder");var s=um_get_data_for_directory(n,"filter_"+t);s=void 0===s?[]:s.split("||"),jQuery.each(s,function(e){var r=u.find('select option[value="'+s[e]+'"]').data("value_label");p.push({name:t,label:a,value_label:r,value:s[e],type:o})})}else if(u.find("div.ui-slider").length){o="slider",t=u.find("div.ui-slider").data("field_name");var e=um_get_data_for_directory(n,"filter_"+t+"_from"),r=um_get_data_for_directory(n,"filter_"+t+"_to");if(void 0===e&&void 0===r)return;a=u.find("div.um-slider-range").data("label");var i=u.find("div.um-slider-range").data("placeholder").replace("{min_range}",e).replace("{max_range}",r).replace("{field_label}",u.find("div.um-slider-range").data("label"));p.push({name:t,label:a,value_label:i,value:[e,r],type:o})}}),p}function um_group_filters_change_tag(e){var r=um_get_group_filters_data(e);e.find(".um-members-filter-tag").remove();var t=e.find(".um-filtered-line");if(t.length){var a=wp.template("um-members-filtered-line");t.prepend(a({filters:r})),0===e.find(".um-members-filter-remove").length?(e.find(".um-clear-filters").hide(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(e.find(".um-clear-filters").show(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible"))}}function um_group_set_range_label(e,r){var t=e.siblings(".um-slider-range").data("placeholder");t=r?t.replace("{min_range}",r.values[0]).replace("{max_range}",r.values[1]).replace("{field_label}",e.siblings(".um-slider-range").data("label")):t.replace("{min_range}",e.slider("values",0)).replace("{max_range}",e.slider("values",1)).replace("{field_label}",e.siblings(".um-slider-range").data("label")),e.siblings(".um-slider-range").html(t),e.siblings(".um_range_min").val(e.slider("values",0)),e.siblings(".um_range_max").val(e.slider("values",1))}function um_get_group_search(e){return e.find(".um-search-line").length?e.find(".um-search-line").val():""}function um_run_group_search(e){if(!um_group_is_directory_busy(e)){um_group_members_show_preloader(e);var r=um_get_data_for_group(e,"search"),t=e.find(".um-search-line").val();t===r||""===t&&void 0===r?um_group_members_hide_preloader(e):(e.data("general_search",t),um_group_set_url_from_data(e,"search",t),e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page",""),e.data("searched",1),e.hasClass("um-groups-users-wrapper")?um_ajax_get_group_members(e):e.hasClass("um-groups-requests-wrapper")?um_ajax_get_group_requests(e):e.hasClass("um-groups-invites-users-wrapper")?um_ajax_get_group_invites(e):e.hasClass("um-groups-blocked-wrapper")&&um_ajax_get_group_blocked(e))}}function um_get_data_for_group(e,r){var t=um_group_members_get_hash(e),a={},u=um_parse_current_url();if(jQuery.each(u,function(e){-1!==e.indexOf("_"+t)&&""!==u[e]&&(a[e.replace("_"+t,"")]=u[e])}),r){if(void 0!==a[r])try{a[r]=decodeURI(a[r])}catch(e){console.error(e)}return a[r]}return a}function um_group_set_url_from_data(e,r,t){var a=um_group_members_get_hash(e),u=um_get_data_for_group(e),s={};""!==t&&(s[r+"_"+a]=t),jQuery.each(u,function(e){r===e?""!==t&&(s[e+"_"+a]=t):s[e+"_"+a]=u[e]}),jQuery.each(um_groups_members_directories,function(e){var r=um_groups_members_directories[e];if(r!==a){var t=um_get_data_for_group(jQuery('.um-directory[data-hash="'+r+'"]'));jQuery.each(t,function(e){s[e+"_"+r]=t[e]})}});var o,i=[];jQuery.each(s,function(e){i.push(e+"="+s[e])}),i=wp.hooks.applyFilters("um_groups_member_directory_url_attrs",i),e.hasClass("um-groups-users-wrapper")?o="tab=members":e.hasClass("um-groups-requests-wrapper")?o="tab=requests":e.hasClass("um-groups-invites-users-wrapper")?o="tab=invites":e.hasClass("um-groups-blocked-wrapper")&&(o="tab=blocked");var n="?"+o;""!==i.join("&")&&(n+="&"+i.join("&")),window.history.pushState("string","UM Groups Member Directory",window.location.origin+window.location.pathname+n)}function um_group_members_get_hash(e){return e.data("hash")}function um_group_is_directory_busy(e){var r=um_group_members_get_hash(e);return void 0!==um_groups_members_directory_busy[r]&&um_groups_members_directory_busy[r]}function um_group_members_show_preloader(e){um_groups_members_directory_busy[um_group_members_get_hash(e)]=!0,e.find(".um-members-overlay").show()}function um_group_members_hide_preloader(e){um_groups_members_directory_busy[um_group_members_get_hash(e)]=!1,e.find(".um-members-overlay").hide()}function um_ajax_get_group_members(a){var u=um_group_members_get_hash(a),e=jQuery(a).attr("data-page");wp.ajax.send("um_groups_get_members",{data:{group_id:u,page:e,nonce:um_scripts.nonce},success:function(e){if(e.users){var r=wp.template("um_groups_members")({users:e.users,group_id:u});if(jQuery(".um-groups-members-list").html(r),a.addClass("um-loaded"),e.pagination){a.attr("total_pages",e.pagination.total_pages);var t=wp.template("um-members-pagination")({pagination:e.pagination});jQuery(".um-members-pagination-box").html(t)}}um_group_members_hide_preloader(a)},error:function(e){console.log(e)}})}function um_ajax_get_group_requests(a){var u=um_group_members_get_hash(a),e=jQuery(a).attr("data-page");wp.ajax.send("um_groups_get_requests",{data:{group_id:u,page:e,nonce:um_scripts.nonce},success:function(e){if(e.users){var r=wp.template("um_groups_members")({users:e.users,group_id:u});if(jQuery(".um-groups-members-list").html(r),a.addClass("um-loaded"),e.pagination){a.attr("total_pages",e.pagination.total_pages);var t=wp.template("um-members-pagination")({pagination:e.pagination});jQuery(".um-members-pagination-box").html(t)}}um_group_members_hide_preloader(a)},error:function(e){console.log(e)}})}function um_ajax_get_group_invites(s){var a=um_group_members_get_hash(s),e=jQuery(s).attr("data-page"),r=um_get_group_search(s),o={group_id:a,page:e,search:r,nonce:um_scripts.nonce};s.find(".um-search-filter").length&&s.find(".um-search-filter").each(function(){var e=jQuery(this);if(e.find(".um-slider").length){var r=e.find(".um-slider").data("field_name"),t=um_get_data_for_group(s,"filter_"+r+"_from"),a=um_get_data_for_group(s,"filter_"+r+"_to");void 0===t&&void 0===a||(o[r]=[t,a])}else if(e.find(".um-datepicker-filter").length){r=e.find(".um-datepicker-filter").data("filter_name"),t=um_get_data_for_group(s,"filter_"+r+"_from"),a=um_get_data_for_group(s,"filter_"+r+"_to");void 0===t&&void 0===a||(o[r]=[t,a])}else if(e.find(".um-timepicker-filter").length){r=e.find(".um-timepicker-filter").data("filter_name"),t=um_get_data_for_group(s,"filter_"+r+"_from"),a=um_get_data_for_group(s,"filter_"+r+"_to");void 0===t&&void 0===a||(o[r]=[t,a])}else{r=e.find("select").attr("name");var u=um_get_data_for_group(s,"filter_"+r);void 0!==u&&(o[r]=u.split("||"))}}),o=wp.hooks.applyFilters("um_group_invites_filter_request",o),wp.ajax.send("um_groups_get_invites",{data:o,success:function(e){if(e.users){var r=wp.template("um_groups_members")({users:e.users,group_id:a});if(jQuery(".um-groups-members-list").html(r),s.addClass("um-loaded"),e.pagination){s.attr("total_pages",e.pagination.total_pages);var t=wp.template("um-members-pagination")({pagination:e.pagination});jQuery(".um-members-pagination-box").html(t)}}um_group_members_hide_preloader(s)},error:function(e){console.log(e)}})}function um_ajax_get_group_blocked(a){var u=um_group_members_get_hash(a),e=jQuery(a).attr("data-page");wp.ajax.send("um_groups_get_blocked",{data:{group_id:u,page:e,nonce:um_scripts.nonce},success:function(e){if(e.users){var r=wp.template("um_groups_members")({users:e.users,group_id:u});if(jQuery(".um-groups-members-list").html(r),a.addClass("um-loaded"),e.pagination){a.attr("total_pages",e.pagination.total_pages);var t=wp.template("um-members-pagination")({pagination:e.pagination});jQuery(".um-members-pagination-box").html(t)}}um_group_members_hide_preloader(a)},error:function(e){console.log(e)}})}jQuery(document).ready(function(){function s(){var e=jQuery("li[class^=um-groups-tab-slug_].active").find(".count");if(e){var r=parseInt(e.text())-1;e.text(r),r<=0&&window.location.reload()}}jQuery(document).on("click",".um-groups-btn-join",function(){var r=jQuery(this),e=r.data("group_id"),t=r.parents("div.actions");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_join_group",group_id:e,nonce:um_scripts.nonce}}).done(function(e){!0===e.status&&(r.addClass("um-groups-btn-leave"),r.removeClass("um-groups-btn-join"),r.text(e.labels.leave),r.addClass("um-groups-btn-join-request"),"public"===e.privacy?(t.find("ul").find("li.count-members").find("span").text(e.members),r.addClass("um-groups-has-joined")):"hidden"===e.privacy&&r.hide(),r.parents(".um-group-single-header").length&&window.location.reload())}).error(function(e){console.log("join group error",e)})}),jQuery(document).on("click",".um-groups-btn-leave",function(){var r=jQuery(this),e=r.data("group_id"),t=r.parents("div.actions");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_leave_group",group_id:e,nonce:um_scripts.nonce}}).done(function(e){e.status&&(r.addClass("um-groups-btn-join"),r.removeClass("um-groups-btn-leave"),r.removeClass("um-groups-btn-join-request"),r.text(e.labels.join),r.attr("data-groups-button-hover",e.labels.hover),"public"!=e.privacy&&"private"!=e.privacy||t.find("ul").find("li.count-members").find("span").text(e.members),r.parents(".um-group-single-header").length&&window.location.reload())}).error(function(e){console.log("leave group error",e)})}),jQuery(document).on({mouseenter:function(){var e=jQuery(this),r=e.attr("data-groups-button-hover");r&&e.text(r),e.addClass("um-groups-btn-leave")},mouseleave:function(){var e=jQuery(this),r=e.attr("data-groups-button-default");r&&e.text(r),e.removeClass("um-groups-btn-leave")}},".um-groups-single-button a.um-button:not(.um-groups-btn-join,.um-groups-has-joined)"),jQuery(document).on({mouseenter:function(){var e=jQuery(this);e.removeClass("disabled"),e.html('<span class="um-faicon-paper-plane-o"></span> '+um_scripts.groups_settings.labels.resend)},mouseleave:function(){var e=jQuery(this);e.addClass("disabled"),e.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.invited)}},'#um-group-buttons .um-group-button[data-action-key="resend_invite"]:not(.um-groups-has-invited)'),jQuery(document).on({mouseenter:function(){var e=jQuery(this);e.find("td").find("select").show(),e.find("td").find("span.label").hide()},mouseleave:function(){var e=jQuery(this);e.find("td").find("select").hide(),e.find("td").find("span.label").show()}},"table#um_groups_manage_members tbody tr"),jQuery("ul.um-groups-single-tabs li:first a").on("click",function(){window.location.href=jQuery(this).attr("href")}),jQuery(document.body).on("click",".um-groups-confirm-invite",function(){var e=jQuery(this),r=e.attr("data-user_id"),t=e.attr("data-group_id")||jQuery('input[name="group_id"]').val();jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_confirm_invite",group_id:t,user_id:r,self:!0,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).error(function(e){console.log(e)})}),jQuery(document.body).on("click",".um-groups-confirm-invite-in-list",function(){var e=jQuery(this),r=e.attr("data-user_id"),t=e.attr("data-group");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_confirm_invite",group_id:t,user_id:r,self:!0,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).error(function(e){console.log(e)})}),jQuery(document.body).on("click",".um-groups-ignore-invite",function(){var e=jQuery(this),r=e.attr("data-user_id"),t=e.attr("data-group_id")||jQuery('input[name="group_id"]').val();jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_ignore_invite",group_id:t,user_id:r,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).error(function(e){console.log(e)})}),jQuery(document.body).on("click",".um-groups-ignore-invite-in-list",function(){var e=jQuery(this),r=e.attr("data-user_id"),t=e.attr("data-group");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_ignore_invite",group_id:t,user_id:r,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).error(function(e){console.log(e)})}),jQuery(document).on("click",".um-group-buttons a.um-group-button-more",function(){var e=jQuery(this);jQuery(".um-group-buttons a.um-group-button-more.active").removeClass("active");var r=e.parent(".um-group-buttons").find("ul[class=um-group-buttons-more]");return r.is(":visible")?r.hide():(jQuery("ul[class=um-group-buttons-more]").hide(),r.show(),e.addClass("active")),!1}),jQuery(document.body).on("click",".um-group-buttons a[data-action-key]",function(){var r=jQuery(this),t=r.parents(".um-groups-user-wrap"),e=r.data("action-key"),a=t.data("group-id"),u=t.data("group-uid");jQuery(".um-groups-single").find(".um-group-members-count").find(".count");switch(e){case"invite":r.hasClass("um-groups-has-invited")||wp.ajax.send("um_groups_send_invitation_mail",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){r.addClass("disabled"),r.addClass("um-groups-has-invited"),r.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.invited)},error:function(e){console.log("send invite error",e)}});break;case"resend_invite":r.hasClass("um-groups-has-invited")||wp.ajax.send("um_groups_send_invitation_mail",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){r.addClass("disabled"),r.addClass("um-groups-has-invited"),r.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.resent_invite)},error:function(e){console.log("resend invite error",error)}});break;case"make-admin":case"make-moderator":case"make-member":wp.ajax.send("um_groups_change_member_role",{data:{group:a,user_id:u,role:e.replace("make-",""),nonce:um_scripts.nonce},success:function(e){r.html(e.menus[e.previous_role]),r.attr("data-action-key","make-"+e.previous_role)},error:function(e){console.log("change member role error",error,e)}});break;case"remove-from-group":confirm(wp.i18n.__("Are you sure that you want to expel this member?","um-groups"))&&wp.ajax.send("um_groups_delete_member",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log(e)}});break;case"remove-self-from-group":confirm(wp.i18n.__("Are you sure that you want to leave this group?","um-groups"))&&wp.ajax.send("um_groups_delete_member",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s(),window.location.reload()},error:function(e){console.log(e)}});break;case"approve":wp.ajax.send("um_groups_approve_user",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log("approve member error",e)}});break;case"reject":wp.ajax.send("um_groups_reject_user",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log("reject member error",e)}});break;case"block":wp.ajax.send("um_groups_block_user",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log("block member error",e)}});break;case"unblock":wp.ajax.send("um_groups_unblock_user",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log("unblock member error",e)}})}return!1}),jQuery(document).on("click",".um-groups-lazy-load",function(){var r=jQuery(this),e={action:"um_groups_load_more_groups",settings:r.data("groups-pagi-settings"),nonce:um_scripts.nonce},t=r.parent(".um-groups-list-pagination"),a=parseInt(r.attr("data-groups-page"))+1;return e.settings.page=a,r.text("..."),jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"json",data:e}).done(function(e){0===e.found.total_groups?(r.text(r.data("no-more-groups-text")),t.remove()):(r.text(r.data("load-more-text")),r.attr("data-groups-page",a),t.before(e.html)),a>=e.found.total_pages&&t.remove()}).error(function(e){r.text(um_scripts.groups_settings.labels.went_wrong)}),!1}),jQuery(".um-groups-single .um-member-directory-filters-a").click(function(){var e=jQuery(this),r=e.parents(".um-groups-invites-users-wrapper").find(".um-search");r.is(":visible")?r.slideUp(250,function(){e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}):r.slideDown({start:function(){jQuery(this).css({display:"grid"}),e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}},250)}),jQuery(".um-groups-users-wrapper").length&&jQuery(".um-groups-users-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_members(e)}),jQuery(".um-groups-requests-wrapper").length&&jQuery(".um-groups-requests-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_requests(e)}),jQuery(".um-groups-invites-users-wrapper").length&&jQuery(".um-groups-invites-users-wrapper").each(function(){var _=jQuery(this),e=um_group_members_get_hash(_);um_groups_members_directories.push(e),um_group_members_show_preloader(_),um_ajax_get_group_invites(_),_.find(".um-slider").each(function(){var e=jQuery(this),t=e.data("field_name"),r=um_get_data_for_group(_,"filter_"+t+"_from"),a=um_get_data_for_group(_,"filter_"+t+"_to");void 0===r&&(r=parseInt(e.data("min"))),void 0===a&&(a=parseInt(e.data("max")));var u=[r,a];e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:u,create:function(e,r){},step:1,slide:function(e,r){um_group_set_range_label(jQuery(this),r)},stop:function(e,r){um_group_is_directory_busy(_)||(um_group_set_url_from_data(_,"filter_"+t+"_from",r.values[0]),um_group_set_url_from_data(_,"filter_"+t+"_to",r.values[1]),_.data("page",1).attr("data-page",1),um_group_set_url_from_data(_,"page",""),um_ajax_get_group_invites(_),um_group_filters_change_tag(_),_.data("searched",1))}}),um_group_set_range_label(e)}),_.find(".um-datepicker-filter").each(function(){var o=jQuery(this),i=new Date(1e3*o.data("date_min")),n=new Date(1e3*o.data("date_max")),e=o.pickadate({selectYears:!0,min:i,max:n,formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){o.blur()},onClose:function(){o.blur()},onSet:function(e){if(!um_group_is_directory_busy(_)){um_group_members_show_preloader(_);var r=o.data("filter_name"),t=o.data("range"),a=um_get_data_for_group(_,"filter_"+r+"_from"),u=um_get_data_for_group(_,"filter_"+r+"_to");void 0===a&&(a=i/1e3),void 0===u&&(u=n/1e3);var s=e.select/1e3;o.val();"from"===t?a=s:"to"===t&&(u=s),um_group_set_url_from_data(_,"filter_"+r+"_from",a),um_group_set_url_from_data(_,"filter_"+r+"_to",u),_.data("page",1).attr("data-page",1),um_group_set_url_from_data(_,"page",""),um_ajax_get_group_invites(_),um_group_filters_change_tag(_),_.data("searched",1)}}}).pickadate("picker"),r=o.data("filter_name"),t=o.data("range"),a=um_get_data_for_group(_,"filter_"+r+"_"+t);void 0!==a&&e.set("select",1e3*a)}),_.find(".um-timepicker-filter").each(function(){var o=jQuery(this),i=o.data("min"),n=o.data("max"),e=i.split(":"),r=n.split(":"),t=o.pickatime({format:o.data("format"),interval:parseInt(o.data("intervals")),min:[e[0],e[1]],max:[r[0],r[1]],formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){o.blur()},onClose:function(){o.blur()},onSet:function(e){if(!um_group_is_directory_busy(_)){um_group_members_show_preloader(_);var r=o.data("filter_name"),t=o.data("range"),a=um_get_data_for_group(_,"filter_"+r+"_from"),u=um_get_data_for_group(_,"filter_"+r+"_to");if(void 0===a&&(a=i),void 0===u&&(u=n),void 0!==e.select){var s=e.select/60;o.val();"from"===t?a=s+":00":"to"===t&&(u=s+":00")}else"from"===t?a=i:"to"===t&&(u=n);um_group_set_url_from_data(_,"filter_"+r+"_from",a),um_group_set_url_from_data(_,"filter_"+r+"_to",u),_.data("page",1).attr("data-page",1),um_group_set_url_from_data(_,"page",""),um_ajax_get_group_invites(_),um_group_filters_change_tag(_),_.data("searched",1)}}}).pickatime("picker"),a=o.data("filter_name"),u=o.data("range"),s=um_get_data_for_group(_,"filter_"+a+"_"+u);if(void 0!==s){var p=s.split(":");t.set("select",60*p[0])}}),um_group_filters_change_tag(_)}),jQuery(".um-groups-blocked-wrapper").length&&jQuery(".um-groups-blocked-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_blocked(e)}),window.addEventListener("popstate",function(e){jQuery(".um-groups-users-wrapper").length&&jQuery(".um-groups-users-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_members(e)}),jQuery(".um-groups-requests-wrapper").length&&jQuery(".um-groups-requests-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_requests(e)}),jQuery(".um-groups-blocked-wrapper").length&&jQuery(".um-groups-blocked-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_blocked(e)}),jQuery(".um-groups-invites-users-wrapper").length&&jQuery(".um-groups-invites-users-wrapper").each(function(){var o=jQuery(this),e=um_group_members_get_hash(o);if(um_groups_members_directories.push(e),um_group_members_show_preloader(o),o.find(".um-groups-members-list, .um-members-pagination-box").html(""),o.find(".um-member-directory-search-line").length){var r=um_get_data_for_group(o,"search");void 0===r&&(r=""),o.data("general_search",r),o.find(".um-search-line").val(r)}var t=um_get_data_for_group(o,"page");void 0===t?t=1:t>o.data("total_pages")&&(t=o.data("total_pages")),o.data("page",t).attr("data-page",t),um_ajax_get_group_invites(o),o.find(".um-datepicker-filter").each(function(){var e=jQuery(this),r=e.pickadate("picker"),t=e.data("filter_name"),a=e.data("range"),u=um_get_data_for_group(o,"filter_"+t+"_"+a);void 0!==u?r.set("select",1e3*u):r.clear()}),o.find(".um-slider").each(function(){var e=jQuery(this),r=e.data("field_name"),t=um_get_data_for_group(o,"filter_"+r+"_from"),a=um_get_data_for_group(o,"filter_"+r+"_to");void 0===t&&(t=e.data("min")),t=parseInt(t),void 0===a&&(a=e.data("max")),a=parseInt(a),e.slider("values",[t,a]),um_group_set_range_label(e)}),o.find(".um-timepicker-filter").each(function(){var e=jQuery(this),r=e.pickatime("picker"),t=e.data("filter_name"),a=e.data("range"),u=um_get_data_for_group(o,"filter_"+t+"_"+a);if(void 0!==u){var s=u.split(":");r.set("select",60*s[0])}else r.clear()}),um_group_filters_change_tag(o)})}),jQuery(document.body).on("click",".um-group-tab-content-wrap .pagi:not(.current)",function(){var e,r;jQuery(this).hasClass("disabled")||(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_group_is_directory_busy(e)||(um_group_members_show_preloader(e),1===(r="first"===jQuery(this).data("page")?1:"prev"===jQuery(this).data("page")?1*e.data("page")-1:"next"===jQuery(this).data("page")?1*e.data("page")+1:"last"===jQuery(this).data("page")?parseInt(e.attr("total_pages")):parseInt(jQuery(this).data("page")))?(e.find('.pagi[data-page="first"], .pagi[data-page="prev"]').addClass("disabled"),e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled")):(r===parseInt(e.attr("total_pages"))?e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').addClass("disabled"):e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled"),e.find('.pagi[data-page="first"], .pagi[data-page="prev"]').removeClass("disabled")),e.find(".pagi").removeClass("current"),e.find('.pagi[data-page="'+r+'"]').addClass("current"),e.data("page",r).attr("data-page",r),um_group_set_url_from_data(e,"page",1===r?"":r),jQuery(this).parents(".um-groups-users-wrapper").length?um_ajax_get_group_members(e):jQuery(this).parents(".um-groups-requests-wrapper").length?um_ajax_get_group_requests(e):jQuery(this).parents(".um-groups-invites-users-wrapper").length?um_ajax_get_group_invites(e):jQuery(this).parents(".um-groups-blocked-wrapper").length&&um_ajax_get_group_blocked(e)))}),jQuery(document.body).on("change",".um-group-tab-content-wrap .um-members-pagi-dropdown",function(){var e;if(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(e)){um_group_members_show_preloader(e);var r=jQuery(this).val();e.find(".pagi").removeClass("current"),e.find('.pagi[data-page="'+r+'"]').addClass("current"),e.data("page",r).attr("data-page",r),um_group_set_url_from_data(e,"page",1===r?"":r),jQuery(this).parents(".um-groups-users-wrapper").length?um_ajax_get_group_members(e):jQuery(this).parents(".um-groups-requests-wrapper").length?um_ajax_get_group_requests(e):jQuery(this).parents(".um-groups-invites-users-wrapper").length?um_ajax_get_group_invites(e):jQuery(this).parents(".um-groups-blocked-wrapper").length&&um_ajax_get_group_blocked(e)}}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-do-search",function(){var e;jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_run_group_search(e)}),jQuery(document.body).on("keypress",".um-group-tab-content-wrap .um-search-line",function(e){var r;13===e.which&&(jQuery(this).parents(".um-groups-users-wrapper").length?r=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?r=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?r=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(r=jQuery(this).parents(".um-groups-blocked-wrapper")),um_run_group_search(r))}),jQuery(".um-group-tab-content-wrap .um-member-directory-filters-a").click(function(){var e=jQuery(this),r=e.parents(".um-directory").find(".um-search");r.is(":visible")?r.slideUp(250,function(){e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}):r.slideDown({start:function(){jQuery(this).css({display:"grid"}),e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}},250)}),jQuery(document.body).on("change",".um-group-tab-content-wrap .um-search-filter select",function(){var e;if(""!==jQuery(this).val()&&(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(e))){um_group_members_show_preloader(e);var r=jQuery(this).prop("name"),t=um_get_data_for_group(e,"filter_"+r);t=void 0===t?[]:t.split("||"),-1===jQuery.inArray(jQuery(this).val(),t)&&(t.push(jQuery(this).val()),um_group_set_url_from_data(e,"filter_"+r,t=t.join("||")),e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page","")),jQuery(this).find('option[value="'+jQuery(this).val()+'"]').prop("disabled",!0).hide(),1===jQuery(this).find("option:not(:disabled)").length&&jQuery(this).prop("disabled",!0),jQuery(this).select2("destroy").select2(),jQuery(this).val("").trigger("change"),um_ajax_get_group_invites(e),um_group_filters_change_tag(e),e.data("searched",1)}}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-members-filter-remove",function(){var e;if(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(e)&&e){um_group_members_show_preloader(e);var r=jQuery(this).data("value"),t=jQuery(this).data("name"),a=jQuery(this).data("type");if("select"===a){var u=um_get_data_for_group(e,"filter_"+t);u=void 0===u?[]:u.split("||"),-1!==jQuery.inArray(r.toString(),u)&&(u=jQuery.grep(u,function(e){return e!==r.toString()})),u.length||(u=""),um_group_set_url_from_data(e,"filter_"+t,u);var s=jQuery('.um-search-filter select[name="'+t+'"]');s.find('option[value="'+r+'"]').prop("disabled",!1).show(),1<s.find("option:not(:disabled)").length&&s.prop("disabled",!1),s.select2("destroy").select2()}else"slider"===a?(um_group_set_url_from_data(e,"filter_"+t+"_from",""),um_group_set_url_from_data(e,"filter_"+t+"_to","")):"datepicker"===a?(um_group_set_url_from_data(e,"filter_"+t+"_from",""),um_group_set_url_from_data(e,"filter_"+t+"_to","")):"timepicker"===a&&(um_group_set_url_from_data(e,"filter_"+t+"_from",""),um_group_set_url_from_data(e,"filter_"+t+"_to",""));e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page",""),jQuery(this).tipsy("hide"),jQuery(this).parents(".um-members-filter-tag").remove(),0===e.find(".um-members-filter-remove").length?e.find(".um-clear-filters").hide():e.find(".um-clear-filters").show(),um_ajax_get_group_invites(e)}}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-clear-filters-a",function(){var s;if(jQuery(this).parents(".um-groups-users-wrapper").length?s=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?s=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?s=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(s=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(s)){if(um_group_members_show_preloader(s),s.find(".um-members-filter-remove").each(function(){var r=jQuery(this).data("value"),e=jQuery(this).data("name"),t=jQuery(this).data("type");if("select"===t){var a=um_get_data_for_directory(s,"filter_"+e);a=void 0===a?[]:a.split("||"),-1!==jQuery.inArray(r.toString(),a)&&(a=jQuery.grep(a,function(e){return e!==r.toString()})),a.length||(a=""),um_group_set_url_from_data(s,"filter_"+e,a);var u=jQuery('.um-search-filter select[name="'+e+'"]');u.find('option[value="'+r+'"]').prop("disabled",!1).show(),1<u.find("option:not(:disabled)").length&&u.prop("disabled",!1),u.select2("destroy").select2()}else"slider"===t?(um_group_set_url_from_data(s,"filter_"+e+"_from",""),um_group_set_url_from_data(s,"filter_"+e+"_to","")):"datepicker"===t?(um_group_set_url_from_data(s,"filter_"+e+"_from",""),um_group_set_url_from_data(s,"filter_"+e+"_to","")):"timepicker"===t&&(um_group_set_url_from_data(s,"filter_"+e+"_from",""),um_group_set_url_from_data(s,"filter_"+e+"_to",""))}),s.data("page",1).attr("data-page",1),um_group_set_url_from_data(s,"page",""),s.find(".um-members-filter-tag").remove(),0===s.find(".um-members-filter-remove").length?(s.find(".um-clear-filters").hide(),s.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(s.find(".um-clear-filters").show(),s.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible")),1===s.data("must-search"))if(!um_get_search(s))return s.data("searched",0),s.find(".um-members-grid, .um-members-list").remove(),s.find(".um-member-directory-sorting-options").prop("disabled",!0),s.find(".um-member-directory-view-type").addClass("um-disabled"),void um_group_members_hide_preloader(s);s.find(".um-member-directory-sorting-options").prop("disabled",!1),s.find(".um-member-directory-view-type").removeClass("um-disabled"),um_ajax_get_group_invites(s)}})});